NEW
  AUTO 3,1
*--------------------------------------
GFX.Open		>PUSHBI 0
				>LDYA L.DEV.GFX
				>SYSCALL Open
				bcs .9

				>STA.G hDevGFX
				
*				ldy #S.PS.hStdIn
*				lda (pPS),y
*				>SYSCALL GetMemPtr
*				>STYA ZPPtr1

*				ldy #S.FD.DEV.DEVID
*				lda (ZPPtr1),y
				
*				>PUSHA
*				>PUSHBI IOCTL.CONTROL
*				>PUSHWI 0
*				>SYSCALL IOCTL

.9				rts
*--------------------------------------
GFX.Close		>LDA.G hDevGFX
				beq .9

				>SYSCALL Close
				
.9				rts				
*--------------------------------------
* (Y X C)
*--------------------------------------
GFX.PLOT		lda #S.CB.CMD.SETPIXEL
				>STA.G GFX.CB+S.CB.CMD 
				lda #S.CB.OP.SET
				>STA.G GFX.CB+S.CB.OP
				lda #S.CB.M.C16
				>STA.G GFX.CB+S.CB.M
				
				>PULLA
				>STA.G GFX.CB+S.CB.COLOR
				
				>PULLA
				
				ldx #4
				ldy #GFX.CB+S.CB.X1+3

.1				>PULLA
				sta (pData),y
				dey
				dex
				bne .1
				
				>PUSHB.G hDevGFX
				>PUSHBI IOCTL.WRITE
				>PUSHEA.G GFX.CB
				>SYSCALL IOCTL
				
				lda pStack
				clc
				adc #6
				sta pStack
				
				rts
*--------------------------------------
* (Y2 X2 Y1 X1 C)
*--------------------------------------
GFX.RECT		lda #S.CB.CMD.FILLRECT
				>STA.G GFX.CB+S.CB.CMD 
				lda #S.CB.OP.SET
				>STA.G GFX.CB+S.CB.OP
				lda #S.CB.M.C16
				>STA.G GFX.CB+S.CB.M
				
				>PULLA
				>STA.G GFX.CB+S.CB.COLOR

				>PULLA

				ldx #8
				ldy #GFX.CB+S.CB.X1+7

.1				>PULLA
				sta (pData),y
				dey
				dex
				bne .1
				
				>PUSHB.G hDevGFX
				>PUSHBI IOCTL.WRITE
				>PUSHEA.G GFX.CB
				>SYSCALL IOCTL
				
				lda pStack
				clc
				adc #10
				sta pStack
				
				rts
*--------------------------------------
*--------------------------------------
*--------------------------------------
*--------------------------------------
MAN
SAVE usr/src/bin/forth.s.gfx
LOAD usr/src/bin/forth.s
ASM
