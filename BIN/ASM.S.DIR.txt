PR#3
PREFIX /A2OSX.SRC
NEW
INC 1
AUTO 6
					.LIST OFF
					.OP	65C02
*---------------------------------------
DIR.AC				clc
					rts
*---------------------------------------
DIR.AS				clc
					rts
*---------------------------------------
DIR.AT				clc
					rts
*---------------------------------------
DIR.AZ				clc
					rts
*---------------------------------------
DIR.BS				clc
					rts
*---------------------------------------
DIR.DA				clc
					rts
*---------------------------------------
DIR.DO				clc
					rts
*---------------------------------------
DIR.DU				clc
					rts
*---------------------------------------
DIR.ED				clc
					rts
*---------------------------------------
DIR.EL				clc
					rts
*---------------------------------------
DIR.EM				ldy #ASM.MA.ON
					lda (pData),y
					bpl .9
					
					lda #$00
					sta (pData),y
					
					clc
					rts
					
.9					lda #ERR.INVALID.MACRO.DEF
					sec
					rts
*---------------------------------------					
DIR.EN				clc
					rts
*---------------------------------------
DIR.EP				clc
					rts
*---------------------------------------
DIR.EQ				clc
					rts
*---------------------------------------
DIR.FI				clc
					rts
*---------------------------------------
DIR.HS				clc
					rts
*---------------------------------------
DIR.IN				jsr SRC.GetArg
					bcs .9
					
					>LDYA L.SRC.BUFFER
					>SYSCALL SYS.NewPStrYA
					
					jsr SRC.OpenFileA
					bcs .99
					rts
					
					
.9					lda #ERR.SYNTAX.ERROR
.99					sec
					rts
*---------------------------------------
DIR.LI				>LDYA L.T.LI
					jsr SRC.GetKeyword
					bcc .1
					
					lda #ERR.SYNTAX.ERROR
					sec
					rts
					
.1					jmp (J.LI,x)
					
DIR.LI.CON			ldy #ASM.LI.CON
					sec 
					bra DIR.LI.APPLY
DIR.LI.COFF			ldy #ASM.LI.CON
					clc
					bra DIR.LI.APPLY
DIR.LI.XON			ldy #ASM.LI.XON
					sec 
					bra DIR.LI.APPLY
DIR.LI.XOFF			ldy #ASM.LI.XON
					clc 
					bra DIR.LI.APPLY
DIR.LI.ON			ldy #ASM.LI.ON
					sec 
					bra DIR.LI.APPLY
DIR.LI.OFF			ldy #ASM.LI.ON
					clc 
DIR.LI.APPLY		lsr
					sta (pData),y
					rts
*---------------------------------------
DIR.MA				ldy #ASM.MA.ON
					lda (pData),y
					bmi .9
					
					lda #$80
					sta (pData),y
					
					jsr SRC.GetArg
					clc
					rts
					
.9					lda #ERR.INVALID.MACRO.DEF
					sec
					rts
*---------------------------------------
DIR.OP				jsr SRC.GetArg
					bcs .9
					
					ldx SRC.Buffer
					lda ASM.T.FILENAMELEN
					adc SRC.Buffer
					sta ASM.T.FILENAME
					tay
					
.1					lda SRC.Buffer,x
					sta ASM.T.FILENAME,y
					dey
					dex
					bne .1
					
					jmp LOAD.ASM.T
					
.9					lda #ERR.SYNTAX.ERROR
					sec
					rts
*---------------------------------------
DIR.OR				clc
					rts
*---------------------------------------
DIR.PG				clc
					rts
*---------------------------------------
DIR.PH				clc
					rts
*---------------------------------------
DIR.SE				clc
					rts
*---------------------------------------
DIR.TA				clc
					rts
*---------------------------------------
DIR.TF				clc
					rts
*---------------------------------------
DIR.TI				clc
					rts
*---------------------------------------
DIR.US				clc
					rts
*---------------------------------------
MAN
SAVE BIN/ASM.S.DIR
LOAD BIN/ASM.S
ASM
