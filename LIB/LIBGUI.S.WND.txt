NEW
PREFIX
AUTO 4,1
*--------------------------------------
WND.Init		>PUSHBI 0
				>LDYA L.DEVNAME.GFX
				>SYSCALL open
				bcs .9
				
				sta hDevGFX
				
				>LDYA L.DCB.GFX
				>STYA IOCTL+S.IOCTL.BUFPTR
				lda #S.IOCTL.STATCODE.GETDCB
				sta IOCTL+S.IOCTL.STATCODE
				
				>PUSHW L.IOCTL
				>PUSHBI IOCTL.STATUS
				lda hDevGFX
				>SYSCALL IOCTL

				bcs .9

				lda DCB.GFX+S.DCB.GFX.W
				sta WND.Cache+S.OBJ.W
				lda DCB.GFX+S.DCB.GFX.W+1
				sta WND.Cache+S.OBJ.W+1
				
				lda SYSFON.H
				clc
				adc #6								
				sta WND.TB.H
				
				lda DCB.GFX+S.DCB.GFX.H
				sec
				sbc SYSFON.H
				sta WND.Cache+S.OBJ.H
				
				lda DCB.GFX+S.DCB.GFX.H+1	
				sbc #0
				sta WND.Cache+S.OBJ.H+1
				
				lda #S.WND.F.NOBORDER
				sta WND.Cache+S.OBJ.F
				
				lda #CUR.T.ARROW
				sta WND.Cache+S.WND.hCUR
				>LDYA L.WND.CACHE
				jsr WND.New
				bcs .9
				
				stx WND.Stack
				
.9				rts				
*--------------------------------------
WND.Quit		lda hDevGFX
				beq .8
				
				pha
				>PUSHBI IOCTL.CLOSE
				>PUSHWI 0
				pla
				>SYSCALL IOCTL

.8				
				clc
				rts
*--------------------------------------
WND.New			>STYA ZPPtr1

				>LDYAI S.WND
				>SYSCALL getmem
				bcs .9
				
				>STYA ZPWNDPtr
				
				ldy #S.WND-1
				
.1				lda (ZPPtr1),y
				sta (ZPWNDPtr),y
				dey
				bpl .1
				
.9				rts				
*--------------------------------------
WND.Paint		>STYA ZPPtr1

				clc
				rts
*--------------------------------------
WND.Close
*--------------------------------------
MAN
SAVE USR/SRC/LIB/LIBGUI.S.WND
LOAD USR/SRC/LIB/LIBGUI.S
ASM
