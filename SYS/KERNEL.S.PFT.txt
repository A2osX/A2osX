PR#3
PREFIX /A2OSX.SRC
NEW
INC 1
AUTO 6
				.LIST OFF
*--------------------------------------
* In : 
*  Y,A = PATH (PSTR)
* Out : 
*  CC : 
*  CS : A = EC
*--------------------------------------
S.PFTCHECKPATHYA
				phx						save #SYSCALL
				>STYA ZPQuickPtr1
				
				>LDYA FltMgr.Table
				>STYA ZPQuickPtr2
				
.1				lda (ZPQuickPtr2)		Get Filter Len
				beq .9					End Of Table, Exit
				tay 
				lda (ZPQuickPtr1),y		is there a "/" at this point in SRC path?
				cmp #'/'
				bne .8
				
.2				lda (ZPQuickPtr1),y	 				
				cmp (ZPQuickPtr2),y	
				bne .8
				dey
				bne .2
				
				lda (ZPQuickPtr2)		get len again
				tay
				iny
				lda (ZPQuickPtr2),y		get hLib
				jsr S.GetMemPtrA
				>STYA .3+1
				
				pla						getback #SYSCALL
				
				pla						discard JSR return @
				pla
				
				>LDYA ZPQuickPtr1		restore passed params
.3				jmp $ffff
				
				
.8				lda ZPQuickPtr2
				clc
				adc (ZPQuickPtr2)		Add STR len
				adc #2					skip hMem & XOffset
				sta ZPQuickPtr2
				bcc .1					always
				
				
.9				plx						restore X from Stack
				rts
*--------------------------------------
* In : 
*  Y,A = PTR to S.DIR
* Out : 
*  CC : Y,A = PTR to S.DIRENT
*  CS : A = EC
*--------------------------------------
S.PFTCHECKFILEYA		

.8				clc
				rts
				
.9				sec
				rts
*--------------------------------------
* In : 
*  Y,A = PTR to S.FILE
*--------------------------------------
S.PFTCHECKDIRYA

				rts

*--------------------------------------

*--------------------------------------
MAN
SAVE SYS/KERNEL.S.PFT
LOAD SYS/KERNEL.S
ASM
