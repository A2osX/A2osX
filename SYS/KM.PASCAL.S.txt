NEW
  AUTO 3,1
				.LIST OFF
				.OP	65C02
				.OR	$2000
				.TF sys/km.pascal
*--------------------------------------
				.INB inc/macros.i
				.INB inc/a2osx.i
				.INB inc/a2osx.api.i
				.INB inc/kernel.i
				.INB inc/mli.e.i
*--------------------------------------
				.DUMMY
				.OR ZPDRV+4				ZPpBuf,ZPCnt
ZS.START
ZS.END			.ED
*--------------------------------------
*			File Header (16 Bytes)
*--------------------------------------
CS.START		cld
				jmp KM.Init				cld,jmp abs=DRV
				.DA #$61				6502,Level 1 (65c02)
				.DA #2					DRV Layout Version 2
				.DA 0
				.DA CS.END
				.DA ID.END
				.DA 0
				.DA 0
*--------------------------------------
* Relocation Table
*--------------------------------------
L.KM.CS.START	.DA KM.CS.START


				.DA 0					End Of Reloc Table
*--------------------------------------				
KM.INIT			>SS
				>PUSHW L.KM.CS.START
				>PUSHWI KM.CS.START
				>PUSHWI KM.CS.END
				>PUSHWI KM.ID.END
				>KAPI InsDrv
				>SR
				bcs .9

				>STYA A2osX.pFSs+FS_PASCAL

.9				rts				
*--------------------------------------
CS.END			.EQ *
*--------------------------------------
* KM Code
*--------------------------------------
				.DUMMY
				.OR ZPDRV

				.ED
*--------------------------------------
KM.CS.START		cld
				jmp (.1,x)

.1				.DA KM.OpenDir
				.DA KM.ReadDir
				.DA KM.CloseDir
*--------------------------------------
KM.OpenDir		sec
				rts
*--------------------------------------
KM.ReadDir		sec
				rts
*--------------------------------------
KM.CloseDir		sec
				rts
*--------------------------------------
KM.CS.END		.EQ *
*--------------------------------------
				
*--------------------------------------
KM.ID.END		.EQ *
*--------------------------------------

*--------------------------------------
ID.END			.EQ *
*--------------------------------------
MAN
SAVE usr/src/sys/km.pascal.s
ASM
