PR#3
PREFIX /A2OSX.BUILD
LOMEM $A00
INC 1
AUTO 6
				.LIST OFF
				.OP	65C02
				.OR	$2000
				.TF SYS/KERNEL

				.INB INC/MACROS.I
				.INB INC/A2OSX.I
				.INB INC/IO.I
				.INB INC/PRODOS.I
				.INB INC/MLI.ERR.I

ZPPtr1			.EQ ZPKERNEL
ZPPtr2			.EQ ZPKERNEL+2
ZPPtr3			.EQ ZPKERNEL+4
ZPPtr4			.EQ ZPKERNEL+6

				sei
 				ldx	#$FF
				txs
				sta SETALTZP

				stx A2osX.SaveSM
				stx A2osX.SaveSX

				sta CLRALTZP			Make sure MAIN ZP is enabled for X.PRINT.F
				cli
				
				jsr Kernel.Init2
				>DEBUGOA
				jmp Kernel.Init3

				.INB /A2OSX.SRC/X.PRINTF.S
				.INB /A2OSX.SRC/SYS/KERNEL.S.INIT2
				.INB /A2OSX.SRC/SYS/KERNEL.S.INIT3

A2osX.GP		.PH $BD00
				.INB /A2OSX.SRC/SYS/KERNEL.S.GP
				.EP
A2osX.GP.E		.EQ *

A2osX.D1		.PH	$D000
				.DA #RRAMWRAMBNK1
				.INB /A2OSX.SRC/SYS/KERNEL.S.FIO
				.INB /A2OSX.SRC/SYS/KERNEL.S.DRV
				.INB /A2OSX.SRC/SYS/KERNEL.S.LIB
				.INB /A2OSX.SRC/SYS/KERNEL.S.TIME
				.INB /A2OSX.SRC/SYS/KERNEL.S.FILE
				.INB /A2OSX.SRC/SYS/KERNEL.S.DIR

				.INB /A2OSX.SRC/SYS/KERNEL.S.PFT
				.INB /A2OSX.SRC/SYS/KERNEL.S.BIN
				.EP
A2osX.D1.E		.EQ *

A2osX.D2		.PH	$D000
				.DA #RRAMWRAMBNK2
				.INB /A2OSX.SRC/SYS/KERNEL.S.CIO
				.INB /A2OSX.SRC/SYS/KERNEL.S.STR
				.INB /A2OSX.SRC/SYS/KERNEL.S.DEV
				.INB /A2OSX.SRC/SYS/KERNEL.S.PS
				.INB /A2OSX.SRC/SYS/KERNEL.S.ARG
				.INB /A2OSX.SRC/SYS/KERNEL.S.ENV
			
				.INB /A2OSX.SRC/SYS/KERNEL.S.RUN
				.INB /A2OSX.SRC/SYS/KERNEL.S.EVT
				.INB /A2OSX.SRC/SYS/KERNEL.S.TSK
				.EP
A2osX.D2.E		.EQ *

A2osX.E0		.PH $E000
				.INB /A2OSX.SRC/SYS/KERNEL.S.JMP
				.INB /A2OSX.SRC/SYS/KERNEL.S.DAT
				.INB /A2OSX.SRC/SYS/KERNEL.S.IRQ
				.INB /A2OSX.SRC/SYS/KERNEL.S.MEM
				.INB /A2OSX.SRC/SYS/KERNEL.S.CNV
				.INB /A2OSX.SRC/SYS/KERNEL.S.CHR
				.INB /A2OSX.SRC/SYS/KERNEL.S.D01
				.EP
A2osX.E0.E		.EQ *
* CONTROL SECTION :
				.LIST ON
A2osX.GP.S		.EQ A2osX.GP.E-A2osX.GP
A2osX.D1.S		.EQ A2osX.D1.E-A2osX.D1
A2osX.D2.S		.EQ A2osX.D2.E-A2osX.D2
A2osX.E0.S		.EQ A2osX.E0.E-A2osX.E0
				.DO A2osX.GP.S>$1E0
* ERROR:GP too big
				.FIN
				.DO A2osX.D1.S>$1000
* ERROR:BNK1 too big
				.FIN
				.DO A2osX.D2.S>$1000
* ERROR:BNK2 too big
				.FIN		
				.LIST OFF
MAN
SAVE /A2OSX.SRC/SYS/KERNEL.S
ASM
